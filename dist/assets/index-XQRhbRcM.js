import{r as N,i as w,j as e,b as M,g as $,a4 as B,u as W,a as l,ae as E,af as H,B as h,ag as j,T as y,c,ah as q,ai as F,aj as G,ak as O,al as z}from"./index-fCbYz-6P.js";import{d as b}from"./Badge-ObDCeuZQ.js";import{d as V}from"./ReplyAll-3zC_kizo.js";import{T as X}from"./TablePagination-hGNVGNlY.js";import{C as J}from"./Container-DdJtpPYi.js";import{G as C}from"./Grid-BhrwLh7C.js";import{T as p}from"./TextField-D13pBZMm.js";import{I as g}from"./InputAdornment-DzH7OAyS.js";import{T as Q}from"./Tooltip-CTC8kJf2.js";import{S as U}from"./Switch-DQFqkRTg.js";import"./Chip-BAZYjULl.js";import"./useThemeProps-Cz-DRPQp.js";import"./FormControlLabel-CKWm9ZMF.js";import"./SwitchBase-CxMVVAa1.js";import"./KeyboardArrowRight-CeattqcP.js";var I={},Y=w;Object.defineProperty(I,"__esModule",{value:!0});var A=I.default=void 0,Z=Y(N()),ee=e;A=I.default=(0,Z.default)((0,ee.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");var T={},te=w;Object.defineProperty(T,"__esModule",{value:!0});var D=T.default=void 0,ne=te(N()),ae=e;D=T.default=(0,ne.default)((0,ae.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone");const je=()=>{const r=M(),{data:d,currentData:u,loading:P,error:f}=$(n=>n.customer),{customerId:t}=B(),i=W(),x={customerId:"",fullName:"",phoneNumber:"",points:"",isActive:!0,isDelete:!1},[a,s]=l.useState(x),S=l.useMemo(()=>[{field:"historyId",headerName:"ID Lịch Sử",width:150},{field:"customerId",headerName:"Mã Khách Hàng",width:150},{field:"points",headerName:"Điểm",width:150},{field:"description",headerName:"Mô Tả",width:300},{field:"transactionDate",headerName:"Ngày Giao Dịch",width:200,renderCell:n=>{const o=new Date(n.row.transactionDate);return`${o.toLocaleDateString()} ${o.toLocaleTimeString()}`}}],[]);l.useEffect(()=>{var o;if(t==="create"){s(x);return}const n=(o=d==null?void 0:d.data)==null?void 0:o.find(v=>v.customerId===t);n?s(n):r(E(t))},[t,d,r]),l.useEffect(()=>{u&&t!=="create"&&s(u)},[u,t]),l.useEffect(()=>{f&&(alert(f),r(H(null)),i("/customer"))},[f,r,i]);const m=n=>{const{name:o,value:v}=n.target;s({...a,[o]:v})},_=()=>{t!=="0"?(r(F(t)),alert("Khách hàng đã được xóa"),i("/customer")):console.log("Lỗi khi xóa khách hàng với customerId: ",t)},k=()=>{t==="create"?r(G(a)).unwrap().then(n=>{alert("Khách hàng đã được thêm thành công!"),i("/customer")}).catch(n=>{alert("Lỗi: Khách hàng đã tồn tại dựa tên số điên thoại.")}):r(O(a)).unwrap().then(n=>{console.log("Customer updated successfully",n),alert("Khách hàng đã được cập nhật thành công!"),i("/customer")}).catch(n=>{console.error("Failed to update customer:",n.message),alert("Lỗi: Không thể cập nhật khách hàng.")})},R=()=>{t!=="create"?(r(z(t)),alert("Khách hàng đã được khôi phục"),i("/customer")):console.log("Lỗi khi khôi phục khách hàng với customerId: ",t)},K=()=>{s(t==="create"?x:u)},L=()=>i("/customer");return P?e.jsxs(h,{sx:{display:"flex",alignItems:"center",justifyContent:"space-around",height:"100%"},children:[e.jsx(j,{animation:"wave",sx:{height:700,width:"30%"}}),e.jsx(j,{animation:"wave",sx:{height:700,width:"30%"}}),e.jsx(j,{animation:"wave",sx:{height:700,width:"30%"}})]}):e.jsxs(J,{maxWidth:"xl",children:[e.jsxs(h,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{marginBottom:2},marginTop:"20px",children:[e.jsx(y,{variant:"h4",align:"left",gutterBottom:!0,sx:{fontWeight:"bold"},children:t==="create"?"Tạo Mới":`Khách Hàng: ${a.fullName}`}),e.jsx(c,{variant:"contained",onClick:L,children:e.jsx(V,{})})]}),e.jsxs(C,{container:!0,spacing:4,children:[e.jsxs(C,{item:!0,xs:6,md:4,children:[e.jsx(p,{label:"Mã Khách Hàng",name:"customerId",value:a.customerId||"",onChange:m,fullWidth:!0,variant:"outlined",disabled:!0,InputProps:{readOnly:t!=="create",endAdornment:e.jsx(g,{position:"end",children:e.jsx(b,{})})},margin:"normal"}),e.jsx(p,{label:"Tên Đầy Đủ",name:"fullName",value:a.fullName||"",onChange:m,fullWidth:!0,variant:"outlined",margin:"normal",InputProps:{endAdornment:e.jsx(g,{position:"end",children:e.jsx(A,{})})}}),e.jsxs(h,{className:"mt-2 ms-1",display:"flex",alignItems:"center",children:[e.jsx(y,{sx:{marginRight:2,fontWeight:"bold"},children:"Trạng Thái Kích Hoạt:"}),e.jsx(Q,{title:a.isActive?"Tài khoản này đang hoạt động":"Tài khoản này đã bị vô hiệu hóa",placement:"top",children:e.jsx(U,{checked:a.isActive,onChange:n=>s({...a,isActive:n.target.checked}),color:"secondary",name:"active"})})]})]}),e.jsxs(C,{item:!0,xs:6,md:4,children:[e.jsx(p,{label:"Số Điện Thoại",name:"phoneNumber",value:a.phoneNumber||"",onChange:m,fullWidth:!0,variant:"outlined",margin:"normal",InputProps:{endAdornment:e.jsx(g,{position:"end",children:e.jsx(D,{})})}}),e.jsx(p,{label:"Điểm",name:"points",value:a.points.toLocaleString()||"",onChange:m,fullWidth:!0,disabled:!0,variant:"outlined",margin:"normal",InputProps:{endAdornment:e.jsx(g,{position:"end",children:e.jsx(b,{})})}})]})]}),e.jsxs(h,{display:"flex",justifyContent:"flex-end",marginTop:5,children:[t==="create"?e.jsx(c,{variant:"contained",color:"primary",onClick:k,sx:{marginRight:2},children:"Lưu"}):e.jsxs(e.Fragment,{children:[a.isDelete?e.jsx(c,{variant:"outlined",color:"info",onClick:R,sx:{marginRight:2},children:"Khôi Phục"}):e.jsx(c,{variant:"outlined",color:"error",onClick:_,sx:{marginRight:2},children:"Xóa"}),e.jsx(c,{variant:"contained",color:"success",onClick:k,sx:{marginRight:2},children:"Cập Nhật"})]}),e.jsx(c,{variant:"outlined",onClick:K,children:"Đặt Lại"})]}),t!=="create"&&e.jsxs(h,{marginTop:5,children:[e.jsx(y,{variant:"h5",fontWeight:"bold",gutterBottom:!0,children:"Lịch Sử Tích Điểm"}),e.jsx(X,{columns:S,stt:!0,id:"historyId",dispatchHandle:q,additionalParams:{customerId:t},sliceName:"pointHistory"})]})]})};export{je as default};
